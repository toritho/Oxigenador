<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Proyecto - Historial</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

</head>

<body class="bg-gray-100">
    <!-- Cabecera con logotipo y botones -->
    <header class="bg-blue-500 text-white p-4 flex flex-wrap items-center justify-between">
        <!-- Logotipo -->
        <div class="flex items-center">
            <img src="../img/logo_Ox_black.png" alt="Logo" class="w-12 h-12 mr-2">
            <h1 class="text-2xl font-bold">Mi Proyecto</h1>
        </div>
    
        <!-- Botones para cada vista -->
        <div class="flex justify-center items-center p-4 lg:w-5/6 lg:justify-center">
            <nav>
                <ul class="flex flex-col lg:flex-row lg:justify-end space-y-4 lg:space-y-0 lg:space-x-14 list-none">
                    <li>
                        <a href="inicio.html" class="text-white font-extrabold text-lg hover:underline transform hover:scale-110 transition duration-300">Inicio</a>
                    </li>
                    <li>
                        <a href="registro.html" class="text-white font-extrabold text-lg hover:underline transform hover:scale-110 transition duration-300">Registros</a>
                    </li>
                    <li>
                        <a href="programarhora.html" class="text-white font-extrabold text-lg hover:underline transform hover:scale-110 transition duration-300">Programación de Horas</a>
                    </li>
                    <li>
                        <a href="consumoenergia.html" class="text-white font-extrabold text-lg hover:underline transform hover:scale-110 transition duration-300">Consumo Energia</a>
                    </li>
                    <li>
                        <a href="historial.html" class="text-white font-extrabold text-lg hover:underline transform hover:scale-110 transition duration-300">Historial</a>
                    </li>
                </ul>
            </nav>
        </div>
        

        <!-- Botón para iniciar sesión en tamaños de pantalla grandes -->
        <div class="flex justify-center p-2 lg:justify-end">
            <a href="http://localhost/proyectoOxigenador/" class="text-white font-bold text-sm hover:underline transform hover:scale-110 transition duration-300 lg:mr-2">Log in <span aria-hidden="true">&rarr;</span></a>
        </div>
        
    </header>

    <!-- Cuerpo (contenedor principal) -->
    <div class="max-w-2xl mx-auto p-6">

        <!-- Contenido específico de la vista historial -->
        <h2 class="text-xl font-bold mb-4">Historial</h2>

        <!-- Tabla para mostrar los datos -->
        <table id="tabla" class="min-w-full bg-white border border-gray-300 rounded-md overflow-hidden shadow-md">
            <thead>
                <tr>
                    <th class="py-2 px-4 border-b bg-gray-300">ID</th>
                    <th class="py-2 px-4 border-b bg-gray-300">id_R</th>
                    <th class="py-2 px-4 border-b bg-gray-300">Estado</th>
                    <th class="py-2 px-4 border-b bg-gray-300">Fecha</th>
                    <th class="py-2 px-4 border-b bg-gray-300">Hora</th>

                </tr>
            </thead>
            <tbody id="tablaBody" class="divide-y divide-gray-300">
                <!-- Aquí se incluirá la lógica JavaScript para llenar los datos -->
            </tbody>
        </table>

    </div>




    <script>
        
        // Función para formatear la hora en formato de 12 horas según la zona horaria de una ciudad
        function formatoHora(hora24) {
            const zonaHoraria = 'America/Bogota'; // Zona horaria de Colombia/Bogotá
            const horaFormateada = luxon.DateTime.fromFormat(hora24, 'HH:mm', { zone: zonaHoraria }).toLocaleString(luxon.DateTime.TIME_SIMPLE);
            return horaFormateada;
        }

        // Realizar la solicitud GET al archivo PHP para obtener los datos
        fetch('../php/historial.php')
        .then(response => response.json())
            .then(data => {
                // Llenar la tabla con los datos obtenidos
                const tablaBody = document.getElementById('tablaBody');
                const maxRows = 20; // Define el número máximo de filas a mostrar

                // Iterar sobre los datos y aplicar el sombreado
                data.slice(0, maxRows).forEach((row, index) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="py-2 px-4 border-b text-center">${row.id}</td>
                        <td class="py-2 px-4 border-b text-center">${row.id_registro}</td>
                        <td class="py-2 px-4 border-b text-center">${row.estado}</td>
                        <td class="py-2 px-4 border-b text-center">${row.fecha}</td>
                        <td class="py-2 px-4 border-b text-center">${row.hora}</td>
                    `;
                    // Aplicar sombreado a cada dos filas
                    if (index % 4 < 2) {
                        tr.classList.add('bg-gray-100');
                    }
                    tablaBody.appendChild(tr);
                });
            })
            .catch(error => console.error('Error al obtener los datos:', error));
    </script>
    |
    <script>


        document.getElementById('limpiarHistorialBtn').addEventListener('click', function () {
            if (confirm('¿Estás seguro de que quieres limpiar todo el historial?')) {
                // Realizar aquí la lógica para limpiar el historial
                limpiarHistorial();
            }
        });




    </script>




</body>

</html>